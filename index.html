<!DOCTYPE html>

<html>
	<head>
		<title>Karaoke Score - Record your singing and get a score</title>
		<script src="stream.js"></script>
		<script src="analysis.js"></script>
		<script src="melody.js"></script>
		<script src="key.js"></script>
		<script src="key-probabilities.js"></script>
		<script src="score.js"></script>
		<script src="display.js"></script>
		<script src="settings.js"></script>
		<link rel="stylesheet" href="style.css">

		<!-- OH NO EXTERNAL LINKS!!! RUNNNNNNNN!!! -->
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Chewy&family=Comic+Relief:wght@400;700&family=Noto+Sans+JP:wght@100..900&family=Noto+Sans:ital,wght@0,100..900;1,100..900&family=Sour+Gummy:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
	</head>
	<body>
		<audio id="drum-roll" src="sounds/karaoke-roll.ogg" style="display: none;"></audio>
		<audio id="good-ending" src="sounds/karaoke-good.ogg" style="display: none;"></audio>
		<audio id="normal-ending" src="sounds/karaoke-normal.ogg" style="display: none;"></audio>
		<audio id="bad-ending" src="sounds/karaoke-bad.ogg" style="display: none;"></audio>
		<audio id="sound-test" src="sounds/karaoke-test.ogg" style="display: none;"></audio>

		<input id="is-fullscreen" type="checkbox" autocomplete="off" style="display: var(--controls-display)"></input>
		<input id="is-settings-open" type="checkbox" autocomplete="off" style="display: var(--controls-display)"></input>
		<input id="is-settings-closed" type="checkbox" autocomplete="off" style="display: var(--controls-display)"></input>
		<input id="show-background" type="checkbox" autocomplete="off" style="display: var(--controls-display)" checked></input>
		<input id="showing-score" type="checkbox" autocomplete="off" style="display: var(--controls-display)"></input>
		<input id="show-score" type="checkbox" autocomplete="off" style="display: var(--controls-display)"></input>
		<input id="effect1" type="checkbox" autocomplete="off" style="display: var(--controls-display)"></input>
		<input id="effect2" type="checkbox" autocomplete="off" style="display: var(--controls-display)"></input>
		<input id="effect3" type="checkbox" autocomplete="off" style="display: var(--controls-display)"></input>
		<input id="effect4" type="checkbox" autocomplete="off" style="display: var(--controls-display)"></input>
		<input id="effect5" type="checkbox" autocomplete="off" style="display: var(--controls-display)"></input>
		<input id="effect6" type="checkbox" autocomplete="off" style="display: var(--controls-display)"></input>
		<input id="effect39" type="checkbox" autocomplete="off" style="display: var(--controls-display)"></input>

		<div id="background"></div>
		<div id="gif-container"><div id="gif"></div></div>
		<div id="flash"></div>

		<div id="score-container">
			<div id="spinner"></div>
			<div id="banner"></div>
			<div id="score">39</div>
			<div class="bloom" id="bloom0"></div>
		</div>

		<div id="message">OO EE OO</div>

		<div id="start-button-container" class="button-container" onclick="getMicAudio()">
			<div id="start-button" class="button">Start Recording</div>
		</div>

		<div id="finish-button-container" class="button-container" onclick="finish()" style="display: none">
			<div id="finish-button" class="button">Stop Recording</div>
		</div>

		<div id="fullscreen-button" onclick="toggleFullscreen()" class="extra-button">
			<div class="icon-flipper">
				<div id="fullscreen-icon" class="icon"></div>
			</div>
			<div id="fullscreen-text">Enter Fullscreen</div>
		</div>

		<div id="settings-button" onclick="openSettings()" class="extra-button">
			<div class="icon-flipper">
				<div id="settings-icon" class="icon">
					<div></div>
					<div></div>
					<div></div>
					<div></div>
				</div>
			</div>
		</div>

		<div id="settings">
			<div id="settings-title">Settings</div>
			<table>
				<tbody>
					<tr>
						<td><div>
							<label for="volume-input">Volume</label>
						</div></td>
						<td><div>
							<input 
								type="range"
								id="volume-slider"
								min="0"
								max="100"
								oninput="document.getElementById('volume-input').value = setVolume(this)"
							>
							<input 
								type="text"
								id="volume-input" 
								size="3"
								oninput="this.value = this.value.replace(/[^0-9\.]/g, '').replace(/(\..*)\./g, '$1')"
								onchange="document.getElementById('volume-slider').value = setVolume(this)"
							>%
						</div></td>
					</tr>
					<tr>
						<td><div>
							<label for="calculation-input">Score Calculation</label>
						</div></td>
						<td><div>
							<input
								type="button"
								id="calculation-input"
								class="cycler"
								onclick="this.value = cycleCalculation()"
							>
						</div></td>
					</tr>
					<tr>
						<td><div>
							<label for="randomization-input">Final Score Randomization</label>
						</div></td>
						<td><div>
							<input
								type="button"
								id="randomization-input"
								class="cycler"
								onclick="this.value = cycleRandomization()"
								value="test"
							>
						</div></td>
					</tr>
				</tbody>
			</table>
			<input type="button" id="settings-reset-button" value="Reset to Default" onclick="resetSettings()">
			<input type="button" id="settings-ok-button" value="OK" onclick="closeSettings()">
		</div>

		<div class="bloom-container" style="top: 25%; left: 25%"><div class="bloom" id="bloom1"></div></div>
		<div class="bloom-container" style="top: 60%; left: 80%"><div class="bloom" id="bloom2"></div></div>
		<div class="bloom-container" style="top: 70%; left: 10%"><div class="bloom" id="bloom3"></div></div>
		<div class="bloom-container" style="top: 15%; left: 70%"><div class="bloom" id="bloom4"></div></div>
	</body>
</html>